<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="824.42">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Hiragino Kaku Gothic Pro}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Osaka}
p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Osaka; color: #a71e12}
p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #a71e12}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #326f17}
p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #a71e12; min-height: 12.0px}
p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #0019b7; min-height: 12.0px}
p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #0019b7}
p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #606060; min-height: 12.0px}
p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Helvetica; min-height: 11.0px}
p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Hiragino Kaku Gothic Pro}
span.s1 {font: 9.0px Monaco}
span.s2 {color: #0019b7}
span.s3 {color: #606060}
span.s4 {color: #000000}
span.s5 {color: #326f17}
span.s6 {font: 9.0px Helvetica}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><b>14.</b></p>
<p class="p2"><br></p>
<p class="p3"><b>キャリアとモジュレータ</b></p>
<p class="p4"><br></p>
<p class="p5">最もシンプルな形式では、1980年代から有名で、ヤマハのDX7も採用した周波数変調（FM）シンセシスは、１つのオシレータを使って他のオシレータの周波数を変調するというものです。FMシンセシスでの変調をかけるためのオシレータは、通常はオーディオ・レートで動作する様に指定され、その振幅はエンベロープや他のオシレータ、すなわち低周波のオシレータ、によって形作られます。</p>
<p class="p4"><br></p>
<p class="p5"><span class="s1">FM</span>合成では、音色はキャリアに対するモジュレータの効果によって異なります。このため、モジュレータは通常オーディオレートで動作する様に指定されます。</p>
<p class="p4"><br></p>
<p class="p6">(</p>
<p class="p6"><span class="s2">SynthDef</span>(<span class="s3">"fm1"</span>, { <span class="s2">arg</span> bus = 0, freq = 440, carPartial = 1, modPartial = 1, index = 3, mul = 0.05;</p>
<p class="p4"><br></p>
<p class="p7"><span class="s1"><span class="Apple-tab-span">	</span>// </span>インデックスの値は通常は0から24まで</p>
<p class="p8"><span class="s4"><span class="Apple-tab-span">	</span></span>// carPartial :: modPartial =&gt; car/mod ratio</p>
<p class="p4"><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">var</span> mod;</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">var</span> car;</p>
<p class="p4"><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>mod = <span class="s2">SinOsc</span>.ar(</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>freq * modPartial,<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0,<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>freq * index * <span class="s2">LFNoise1</span>.kr(5.reciprocal).abs</p>
<p class="p6"><span class="Apple-tab-span">	</span>);</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>car = <span class="s2">SinOsc</span>.ar(</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(freq * carPartial) + mod,<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0,<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mul</p>
<p class="p6"><span class="Apple-tab-span">	</span>);</p>
<p class="p4"><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">Out</span>.ar(</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bus,</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>car</p>
<p class="p6"><span class="Apple-tab-span">	</span>)</p>
<p class="p6">}).load(s);</p>
<p class="p6">)</p>
<p class="p4"><br></p>
<p class="p6">(</p>
<p class="p9"><span class="s2">Synth</span><span class="s4">(</span><span class="s3">"fm1"</span><span class="s4">, [</span>\bus<span class="s4">, 0, </span>\freq<span class="s4">, 440, </span>\carPartial<span class="s4">, 1, </span>\modPartial<span class="s4">, 2.4]);</span></p>
<p class="p6"><span class="s2">Synth</span>(<span class="s3">"fm1"</span>, [<span class="s5">\bus</span>, 1, <span class="s5">\freq</span>, 442, <span class="s5">\carPartial</span>, 1, <span class="s5">\modPartial</span>, 2.401]);</p>
<p class="p6">)</p>
<p class="p10"><br></p>
<p class="p8">////////////////////////////////////////////////////////////////////////////////////////////////////</p>
<p class="p4"><br></p>
<p class="p3"><b>周波数変調とリバーブ</b></p>
<p class="p11"><br></p>
<p class="p7"><span class="s1">// </span>これは（SC2の配布物の中の）"01 Why SuperCollider document"からのリバーブ</p>
<p class="p6">(</p>
<p class="p6"><span class="s2">SynthDef</span>(<span class="s3">"preDelay"</span>, { <span class="s2">arg</span> inbus = 2;</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">Out</span>.ar(</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>4,</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">DelayN</span>.ar(<span class="s2">In</span>.ar(inbus, 1), 0.048, 0.048)</p>
<p class="p6"><span class="Apple-tab-span">	</span>)</p>
<p class="p6">}).load(s);</p>
<p class="p4"><br></p>
<p class="p12">SynthDef<span class="s4">(</span><span class="s3">"combs"</span><span class="s4">, {</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">Out</span>.ar(</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>6,</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Mix</span>.arFill(7, { <span class="s2">CombL</span>.ar(<span class="s2">In</span>.ar(4, 1), 0.1, <span class="s2">LFNoise1</span>.kr(<span class="s2">Rand</span>(0, 0.1), 0.04, 0.05), 15) })</p>
<p class="p6"><span class="Apple-tab-span">	</span>)</p>
<p class="p6">}).load(s);</p>
<p class="p4"><br></p>
<p class="p6"><span class="s2">SynthDef</span>(<span class="s3">"allpass"</span>, { <span class="s2">arg</span> gain = 0.2;</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">var</span> source;</p>
<p class="p6"><span class="Apple-tab-span">	</span>source = <span class="s2">In</span>.ar(6, 1);</p>
<p class="p6"><span class="Apple-tab-span">	</span>4.do({ source = <span class="s2">AllpassN</span>.ar(source, 0.050, [<span class="s2">Rand</span>(0, 0.05), <span class="s2">Rand</span>(0, 0.05)], 1) });</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">Out</span>.ar(</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>8,</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>source * gain</p>
<p class="p6"><span class="Apple-tab-span">	</span>)</p>
<p class="p6">}).load(s);</p>
<p class="p4"><br></p>
<p class="p6"><span class="s2">SynthDef</span>(<span class="s3">"theMixer"</span>, { arg gain = 1;</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">Out</span>.ar(</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0,</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">Mix</span>.ar([<span class="s2">In</span>.ar(2, 1), <span class="s2">In</span>.ar(8, 2)]) * gain</p>
<p class="p6"><span class="Apple-tab-span">	</span>)</p>
<p class="p6">}).load(s);</p>
<p class="p6">)</p>
<p class="p13"><br></p>
<p class="p6">(</p>
<p class="p6"><span class="s2">Synth</span>(<span class="s3">"fm1"</span>, [<span class="s5">\bus</span>, 2, <span class="s5">\freq</span>, 440, <span class="s5">\carPartial</span>, 1, <span class="s5">\modPartial</span>, 1.99, <span class="s5">\mul</span>, 0.071]);</p>
<p class="p6"><span class="s2">Synth</span>(<span class="s3">"fm1"</span>, [<span class="s5">\bus</span>, 2, <span class="s5">\freq</span>, 442, <span class="s5">\carPartial</span>, 1, <span class="s5">\modPartial</span>, 2.401, <span class="s5">\mul</span>, 0.071]);</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"preDelay"</span>);</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"combs"</span>);</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"allpass"</span>);</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"theMixer"</span>, [<span class="s5">\gain</span>, 0.64]);</p>
<p class="p6">)</p>
<p class="p10"><br></p>
<p class="p8">////////////////////////////////////////////////////////////////////////////////////////////////////</p>
<p class="p14"><br></p>
<p class="p3"><b>コンポーネント</b></p>
<p class="p4"><br></p>
<p class="p15"><span class="s6">"fm"</span>のSynthDefを、1つのSynthDefはモジュレータ、1つのSynthDefはキャリアという2つの部分に分割する、ことでより機能性が高まる。キャリアのシグナルを2つまたはそれ以上のモジュレータで加工することができる。</p>
<p class="p14"><br></p>
<p class="p6">(</p>
<p class="p6"><span class="s2">SynthDef</span>(<span class="s3">"carrier"</span>, { <span class="s2">arg</span> inbus = 2, outbus = 0, freq = 440, carPartial = 1, index = 3, mul = 0.2;</p>
<p class="p4"><br></p>
<p class="p7"><span class="s1"><span class="Apple-tab-span">	</span>// </span>インデックスの値は通常は0から24まで</p>
<p class="p8"><span class="s4"><span class="Apple-tab-span">	</span></span>// carPartial :: modPartial =&gt; car/mod ratio</p>
<p class="p4"><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">var</span> mod;</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">var</span> car;</p>
<p class="p4"><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>mod = <span class="s2">In</span>.ar(inbus, 1);</p>
<p class="p4"><br></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">Out</span>.ar(</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>outbus,</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">SinOsc</span>.ar((freq * carPartial) + mod, 0, mul);</p>
<p class="p6"><span class="Apple-tab-span">	</span>)</p>
<p class="p6">}).load(s);</p>
<p class="p4"><br></p>
<p class="p6"><span class="s2">SynthDef</span>(<span class="s3">"modulator"</span>, { <span class="s2">arg</span> outbus = 2, freq, modPartial = 1, index = 3;</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s2">Out</span>.ar(</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>outbus,</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">SinOsc</span>.ar(freq * modPartial, 0, freq)<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>*<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">LFNoise1</span>.kr(<span class="s2">Rand</span>(3, 6).reciprocal).abs<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>*<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index</p>
<p class="p6"><span class="Apple-tab-span">	</span>)</p>
<p class="p6">}).load(s);</p>
<p class="p6">)</p>
<p class="p4"><br></p>
<p class="p6">(</p>
<p class="p6"><span class="s2">var</span> freq = 440;</p>
<p class="p7"><span class="s1">// </span>左チャンネルのためのモジュレータ</p>
<p class="p6"><span class="s2">Synth</span>.head(s, <span class="s3">"modulator"</span>, [<span class="s5">\outbus</span>, 2, <span class="s5">\freq</span>, freq, <span class="s5">\modPartial</span>, 0.649, <span class="s5">\index</span>, 2]);</p>
<p class="p6"><span class="s2">Synth</span>.head(s, <span class="s3">"modulator"</span>, [<span class="s5">\outbus</span>, 2, <span class="s5">\freq</span>, freq, <span class="s5">\modPartial</span>, 1.683, <span class="s5">\index</span>, 2.31]);</p>
<p class="p4"><br></p>
<p class="p7"><span class="s1">// </span>右チャンネルのためのモジュレータ</p>
<p class="p6"><span class="s2">Synth</span>.head(s, <span class="s3">"modulator"</span>, [<span class="s5">\outbus</span>, 4, <span class="s5">\freq</span>, freq, <span class="s5">\modPartial</span>, 0.729, <span class="s5">\index</span>, 1.43]);</p>
<p class="p6"><span class="s2">Synth</span>.head(s, <span class="s3">"modulator"</span>, [<span class="s5">\outbus</span>, 4, <span class="s5">\freq</span>, freq, <span class="s5">\modPartial</span>, 2.19, <span class="s5">\index</span>, 1.76]);</p>
<p class="p4"><br></p>
<p class="p7"><span class="s1">// </span>左と右のチャンネルのためのキャリア</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"carrier"</span>, [<span class="s5">\inbus</span>, 2, <span class="s5">\outbus</span>, 0, <span class="s5">\freq</span>, freq, <span class="s5">\carPartial</span>, 1]);</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"carrier"</span>, [<span class="s5">\inbus</span>, 4, <span class="s5">\outbus</span>, 1, <span class="s5">\freq</span>, freq, <span class="s5">\carPartial</span>, 0.97]);</p>
<p class="p6">)</p>
<p class="p14"><br></p>
<p class="p8">////////////////////////////////////////////////////////////////////////////////////////////////////</p>
<p class="p14"><br></p>
<p class="p3"><b>コンポーネントとリバーブ</b></p>
<p class="p4"><br></p>
<p class="p5">この例は前に定義されたリバーブと２つのシンセ定義（モジュレータが１つのSynthDefで他方はキャリア）で説明したモデルを組み合わせています。</p>
<p class="p4"><br></p>
<p class="p6">(</p>
<p class="p6"><span class="s2">var</span> freq;</p>
<p class="p7"><span class="s1">// </span>キャリアとモジュレータのためのランダムな基本周波数を生成する</p>
<p class="p6">freq = 330.0.rrand(500);</p>
<p class="p4"><br></p>
<p class="p7"><span class="s1">// </span>左チャンネルのためのモジュレータ</p>
<p class="p6"><span class="s2">Synth</span>.head(s, <span class="s3">"modulator"</span>, [<span class="s5">\outbus</span>, 60, <span class="s5">\freq</span>, freq, <span class="s5">\modPartial</span>, 0.649, <span class="s5">\index</span>, 2]);</p>
<p class="p6"><span class="s2">Synth</span>.head(s, <span class="s3">"modulator"</span>, [<span class="s5">\outbus</span>, 60, <span class="s5">\freq</span>, freq, <span class="s5">\modPartial</span>, 1.683, <span class="s5">\index</span>, 2.31]);</p>
<p class="p4"><br></p>
<p class="p7"><span class="s1">// </span>右チャンネルのためのモジュレータ</p>
<p class="p6"><span class="s2">Synth</span>.head(s, <span class="s3">"modulator"</span>, [<span class="s5">\outbus</span>, 62, <span class="s5">\freq</span>, freq, <span class="s5">\modPartial</span>, 1.11, <span class="s5">\index</span>, 1.43]);</p>
<p class="p6"><span class="s2">Synth</span>.head(s, <span class="s3">"modulator"</span>, [<span class="s5">\outbus</span>, 62, <span class="s5">\freq</span>, freq, <span class="s5">\modPartial</span>, 0.729, <span class="s5">\index</span>, 1.76]);</p>
<p class="p4"><br></p>
<p class="p7"><span class="s1">// </span>左と右のチャンネルのためのキャリア</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"carrier"</span>, [<span class="s5">\inbus</span>, 60, <span class="s5">\outbus</span>, 100, <span class="s5">\freq</span>, freq, <span class="s5">\carPartial</span>, 1]);</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"carrier"</span>, [<span class="s5">\inbus</span>, 62, <span class="s5">\outbus</span>, 100, <span class="s5">\freq</span>, freq+1, <span class="s5">\carPartial</span>, 2.91]);</p>
<p class="p14"><br></p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"preDelay"</span>, [<span class="s5">\inbus</span>, 100]);</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"combs"</span>);</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"allpass"</span>);</p>
<p class="p6"><span class="s2">Synth</span>.tail(s, <span class="s3">"theMixer"</span>, [<span class="s5">\gain</span>, 0.2]);</p>
<p class="p6">)</p>
<p class="p4"><br></p>
<p class="p8">////////////////////////////////////////////////////////////////////////////////////////////////////</p>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="949.54">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; color: #001bec}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica}
p.p6 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p7 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica}
p.p8 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p9 {margin: 0.0px 0.0px 0.0px 85.0px; text-indent: -85.0px; font: 12.0px Helvetica}
p.p10 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 14.0px Helvetica}
p.p11 {margin: 0.0px 0.0px 0.0px 85.0px; text-indent: -85.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p12 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 14.0px Helvetica; min-height: 17.0px}
p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica; min-height: 17.0px}
p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #bf0000}
p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000; min-height: 12.0px}
p.p16 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000}
p.p17 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #606060}
span.s1 {font: 18.0px Helvetica}
span.s2 {color: #002fb1}
span.s3 {color: #000000}
span.s4 {text-decoration: underline}
span.s5 {text-decoration: underline ; color: #002fb1}
span.s6 {color: #0036f4}
span.s7 {font: 14.0px Helvetica}
span.s8 {text-decoration: underline ; color: #001bec}
span.s9 {text-decoration: underline ; color: #000000}
span.s10 {color: #0000bf}
span.s11 {color: #007300}
span.s12 {color: #606060}
span.s13 {color: #bf0000}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><span class="s1"><b>SCUserView<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></span><b>user-definable view</b><span class="s1"><b><span class="Apple-tab-span">	</span></b></span></p>
<p class="p2"><br></p>
<p class="p1"><b>Inherits from: </b><a href="../../Core/Object.html"><span class="s2"><b>Object</b></span></a><b> : </b><a href="SCView.html"><span class="s2"><b>SCView</b></span></a></p>
<p class="p3"><br></p>
<p class="p1">SCUserView is a user-definable View intended mainly for use with Pen and drawHooks. It is also good for making custom buttons or other gui interfaces and displays. Thus anything you can draw with the methods of <a href="SCPen.html"><span class="s2">Pen</span></a>, combined with mouse tracking, can be used to create a vast variety of interfaces and displays. When a view is refreshed, either maunually, or triggered by a refresh of the parent view, drawFunc is evaluated. Using <b>refreshInRect </b>constrains the receiver's refresh area to the rectangle passed in a Rect (see <a href="SCView.html"><span class="s2">SCView</span></a>).</p>
<p class="p2"><br></p>
<p class="p4"><span class="s3"><b>See also: </b><a href="../GUI-Overview.html"><span class="s4">GUI-Overview</span></a><b>,</b> <a href="SCWindow.html"><span class="s5">SCWindow</span></a>, <a href="SCPen.html"><span class="s5">Pen</span></a>, <a href="../GUI-Tools/Color.html"><span class="s5">Color</span></a>, and <a href="../../Collections/String.html"><span class="s5">String</span></a> <a href="SCUserViewSubclassing/SCUserView-Subclassing.html"><span class="s4">SCUserView-Subclassing</span></a></span></p>
<p class="p2"><br></p>
<p class="p5"><b>Creation / Class Methods</b></p>
<p class="p6"><br></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>*new (parent, bounds)</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>parent </b>- The parent view.</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>bounds </b>- An instance of <a href="../../Geometry/Rect.html"><span class="s2">Rect</span></a>, or a <a href="../../Geometry/Point.html"><span class="s2">Point</span></a> indicating width@height.</p>
<p class="p6"><br></p>
<p class="p10"><b>Accessing Instance and Class Variables</b></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>drawFunc_(arg1)</b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>drawFunc</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Set the function which should be evaluated if the view is refreshed. This happens every time the view or the whole window is refreshed (manually by calling SCView:refresh, SCWindow:refresh or e.g. by selecting the view or resizing the window).</p>
<p class="p7">.</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>arg1 </b>- An instance of <a href="../../Core/Kernel/Function.html"><span class="s2">Function</span></a>. Default value is nil. Refreshing passes the instance of SCUserView itself as the first argument to the function.</p>
<p class="p6"><br></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>clearOnRefresh</b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>clearOnRefresh_ (bool)</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Determines whether the drawn content of the view is cleared on refresh.</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>bool </b>- An instance of <a href="../../Core/Boolean.html"><span class="s2">Boolean</span></a>. Default value is true.</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9"><b><span class="Apple-tab-span">	</span>drawingEnabled</b></p>
<p class="p9"><b><span class="Apple-tab-span">	</span>drawingEnabled_(bool)</b></p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Determines whether to execute the draw function or not</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>bool </b>- An instance of <a href="../../Core/Boolean.html"><span class="s2">Boolean</span></a>. Default value is true.</p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>animate_(bool)</b></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Determines whether the view should refresh itself internally at a constant frame rate or not.</p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Use thisProcess.setDeferredTaskInterval(1/fps) to change this global frame rate. The default is 60fps.</p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>bool </b>- An instance of <a href="../../Core/Boolean.html"><span class="s2">Boolean</span></a>. Default value is false.</p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>frame</b></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>An <a href="../../Math/Integer.html"><span class="s6">Integer</span></a> counter that increases by one each time the view is redrawn. Useful for driving animation.</p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>frameRate</b></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>A <a href="../../Math/Float.html"><span class="s6">Float</span></a> that represents the current average frame rate. Useful for benchmarking while animating. If this value drops below 60, it is an indication of that the current drawFunc is heavy for the program to execute.</p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>draw</b></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Evaluates the draw function, passing the instance of SCUserView itself as the first argument to the function</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>clearDrawing</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>If <b>clearOnRefresh</b> is set to false, then you can use this to manually clear the drawing (you must refesh in order for it to show)</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p10"><b>Deprecated</b></p>
<p class="p12"><br></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>mousePosition</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Deprecated</b>. R the relative position of the mouse cklick as a <a href="../../Geometry/Point.html"><span class="s2">Point</span></a>.</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p10"><b>Subclassing and Internal Methods</b></p>
<p class="p7"><span class="s7"><span class="Apple-tab-span">	</span></span>The following methods are usually not used directly or are called by a primitive. Programmers can still call or override these as needed. For a Tutorial on how to subclass SCUserView to make your own custom GUI Widgets, see <a href="SCUserViewSubclassing/SCUserView-Subclassing.html"><span class="s2">SCUserView-Subclassing</span></a></p>
<p class="p6"><br></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>init (argParent, argBounds)</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span></b><span class="Apple-tab-span">	</span><b>parent </b>- The parent view.</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>bounds </b>- An instance of <a href="../../Geometry/Rect.html"><span class="s2">Rect</span></a>, or a <a href="../../Geometry/Point.html"><span class="s2">Point</span></a> indicating width@height.</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>keyDownFunc</b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>keyDownFunc_ (action)</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Deprecated. Use <b>keyDownAction</b> instead. See <a href="SCView.html"><span class="s2">SCView</span></a>.</p>
<p class="p6"><br></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>mouseDownFunc</b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>mouseDownFunc_ (action)</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Deprecated. Use <b>mouseDownAction</b> instead. See <a href="SCView.html"><span class="s2">SCView</span></a>.</p>
<p class="p6"><br></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>mouseMoveFunc</b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>mouseMoveFunc_ (action)</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Deprecated. Use <b>mouseMoveAction</b> instead. See <a href="SCView.html"><span class="s2">SCView</span></a>.</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>mouseUpFunc</b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span>mouseUpFunc_ (action)</b></p>
<p class="p8"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Deprecated. Use <b>mouseUpAction</b> instead. See <a href="SCView.html"><span class="s2">SCView</span></a>.</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p10"><b>Examples</b></p>
<p class="p13"><br></p>
<p class="p1"><span class="s8"><a href="../GUI-Overview.html">GUI<span class="s9">-</span><span class="s4">Overview</span></a></span> contains an elobarate example on how to make a gui widget with <span class="s2">SCUserView</span> using interface level coding. <span class="s2">For</span> a <span class="s2">Tutorial</span> on how to write a subclass of <span class="s2">SCUserView</span> to make your own custom <span class="s2">GUI</span> <span class="s2">Widgets</span>, see <a href="SCUserViewSubclassing/SCUserView-Subclassing.html"><span class="s2">SCUserView</span><span class="s5">-</span><span class="s2">Subclassing</span></a></p>
<p class="p12"><br></p>
<p class="p14">// Basic Usage. Resize the window to refresh the drawing. Or use mouse click.</p>
<p class="p15"><br></p>
<p class="p16">(<span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>w=<span class="s10">Window</span>.new;</p>
<p class="p16"><span class="Apple-tab-span">	</span>v=<span class="s10">UserView</span>(w, w.view.bounds.insetBy(50,50));</p>
<p class="p16"><span class="Apple-tab-span">	</span>v.background_(<span class="s10">Color</span>.rand);</p>
<p class="p16"><span class="Apple-tab-span">	</span>v.drawFunc={<span class="s10">|uview|</span></p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.moveTo(0@uview.bounds.height.rand);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.lineTo(uview.bounds.width@uview.bounds.height.rand);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.stroke;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p16"><span class="Apple-tab-span">	</span>v.mouseDownAction={v.refresh};</p>
<p class="p16"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p14">// Coordinates are relative to the SCUserView</p>
<p class="p14">// Try resizing the Window.</p>
<p class="p15"><br></p>
<p class="p16">(<span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">var</span> func;</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>func = {<span class="s10">|me|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.use{</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.perform([<span class="s11">\stroke</span>, <span class="s11">\fill</span>].choose);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p17"><span class="s3"><span class="Apple-tab-span">	</span>w = </span><span class="s10">SCWindow</span><span class="s3">.new(</span>"DrawFunc Examples"<span class="s3">).front;</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>w.view.background_(<span class="s10">Color</span>.white);</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>3.do{<span class="s10">|i|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v = <span class="s10">SCUserView</span>(w, <span class="s10">Rect</span>(20+(i*120), 100, 100, 100))</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.drawFunc_(func);</p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.resize=3; </span>// the func coordinates ar valid even though the view move on resize</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.background_(<span class="s10">Color</span>.rand);</p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>w.refresh;</p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p14">// Mouse Tracking</p>
<p class="p14">// Set the function which should be evaluated if the mouse is at the end of tracking (mouse-up).</p>
<p class="p14">// This function will be passed four arguments: theView, x coordinate, y coordinate, and keyboard modifiers.</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16">(</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">var</span> drawFunc, mouseDownFunc, mouseUpFunc, mouseMoveFunc, sat = 0, startX;</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>drawFunc = {<span class="s10">|me|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.use{</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.perform([<span class="s11">\stroke</span>, <span class="s11">\fill</span>].choose);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>mouseDownFunc = {<span class="s10">|me, x, y, mod|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>startX = x;</p>
<p class="p17"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>postf(</span>"begin path: x=% realtive mouse coordinates:%\n"<span class="s3">,startX, x@y);</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>mouseUpFunc = {<span class="s10">|me, x, y, mod|</span></p>
<p class="p17"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>postf(</span>"end path: (startX-x)==% mouse coordinates:%\n"<span class="s3">,(startX-x), x@y);</span></p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>mouseMoveFunc = {<span class="s10">|me, x, y, mod|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sat = ((startX-x)/100);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(x@y).postln;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>me.refresh;</p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>w = <span class="s10">SCWindow</span>.new.front;</p>
<p class="p16"><span class="Apple-tab-span">	</span>w.view.background_(<span class="s10">Color</span>.white);</p>
<p class="p16"><span class="Apple-tab-span">	</span>3.do{<span class="s10">|i|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v = <span class="s10">SCUserView</span>(w, <span class="s10">Rect</span>(20+(i*120), 100, 100, 100));</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.background_(<span class="s10">Color</span>.rand);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.drawFunc = drawFunc;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.mouseDownAction = mouseDownFunc;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.mouseUpAction = mouseUpFunc;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.mouseMoveAction = mouseMoveFunc;</p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p16"><span class="Apple-tab-span">	</span>w.refresh;</p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p14">// Prevent redrawing:</p>
<p class="p15"><br></p>
<p class="p16">(<span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">var</span> func, views;</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>func = {<span class="s10">|me|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.use{</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10.do{</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Color</span>.red(rrand(0.0, 1), rrand(0.0, 0.5)).set;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.addArc((400.exprand(2))@(100.rand), rrand(10, 100), 2pi.rand, pi);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.perform([<span class="s11">\stroke</span>, <span class="s11">\fill</span>].choose);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p17"><span class="s3"><span class="Apple-tab-span">	</span>w = </span><span class="s10">SCWindow</span><span class="s3">.new(</span>"DrawFunc Examples"<span class="s3">).front;</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>w.view.background_(<span class="s10">Color</span>.white);</p>
<p class="p16"><span class="Apple-tab-span">	</span>views = {<span class="s10">|i|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v = <span class="s10">SCUserView</span>(w, <span class="s10">Rect</span>(20+(i*120), 100, 100, 100));</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.drawFunc = func;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.clearOnRefresh_(<span class="s10">false</span>);</p>
<p class="p16"><span class="Apple-tab-span">	</span>} ! 3;</p>
<p class="p16"><span class="Apple-tab-span">	</span>w.refresh;</p>
<p class="p16"><span class="Apple-tab-span">	</span>{views.do{<span class="s10">|v|</span> v.drawFunc = <span class="s10">nil</span>}}.defer(0.4);</p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p14">// Use the mouse to draw on the view</p>
<p class="p15"><br></p>
<p class="p16">(</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">var</span> w, txt, tmppoints, all;</p>
<p class="p16"><span class="Apple-tab-span">	</span>tmppoints = [];</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>w = <span class="s10">SCWindow</span>(<span class="s12">"draw on me"</span>, <span class="s10">Rect</span>(128, 64, 340, 360));</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>v = <span class="s10">SCUserView</span>(w,w.view.bounds)</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.mouseMoveAction_({<span class="s10">|v,x,y|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[x,y].postln;</p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tmppoints = tmppoints.add(x@y);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.refresh;</p>
<p class="p16"><span class="Apple-tab-span">	</span>})</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.mouseUpAction_({<span class="s10">|v,x,y|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>all = all.add(tmppoints.copy);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tmppoints = [];</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.refresh;</p>
<p class="p16"><span class="Apple-tab-span">	</span>})</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.drawFunc_{<span class="s10">|me|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.use {<span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Color</span>.white.set;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillRect(me.bounds.moveTo(0,0));<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.width = 1;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Color</span>.black.set;</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.beginPath;</p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tmppoints.do{<span class="Apple-tab-span">	</span><span class="s10">|p, i|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(i == 0){</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.moveTo(p);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}{</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.lineTo(p);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>all.do{<span class="s10">|points|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>points.do{<span class="s10">|p, i|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(i == 0){</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.moveTo(p);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}{</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.lineTo(p);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.stroke;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};<span class="Apple-tab-span">	</span></p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p14">// Animation</p>
<p class="p14">// with mouse interaction</p>
<p class="p15"><br></p>
<p class="p16">(</p>
<p class="p16"><span class="s10">var</span> width = 400, height = 400, mx = 0, my = 0;</p>
<p class="p16">w = <span class="s10">Window</span>(<span class="s12">"animation and mouse interaction"</span>, <span class="s10">Rect</span>(100, 200, width, height), <span class="s10">false</span>);</p>
<p class="p16">u = <span class="s10">UserView</span>(w, <span class="s10">Rect</span>(0, 0, width, height));</p>
<p class="p16">u.background = <span class="s10">Color</span>.black;</p>
<p class="p16">u.animate = <span class="s10">true</span>;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s13">//animate this view</span></p>
<p class="p16">u.drawFunc = {</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillColor = <span class="s10">Color</span>.green;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.stringAtPoint(u.frameRate.asString, <span class="s10">Point</span>(10, 10));<span class="Apple-tab-span">	</span><span class="s13">//get frame rate</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.stringAtPoint(u.frame.asString, <span class="s10">Point</span>(10, 30));<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s13">//get frame counter</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.color = <span class="s10">Color</span>.white;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.moveTo(<span class="s10">Point</span>(my, mx));</p>
<p class="p16"><span class="Apple-tab-span">	</span>100.do{<span class="s10">|i|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">var</span> x = sin(u.frame*0.04.neg+i)*(5*i)+mx;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s13">//use .frame to drive animation</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">var</span> y = cos(u.frame*0.05+i)*(5*i)+my;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.lineTo(<span class="s10">Point</span>(y, x));</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.addOval(<span class="s10">Rect</span>(x, y, i, i));</p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillStroke;</p>
<p class="p16">};</p>
<p class="p16">u.mouseDownAction = {<span class="s10">|v, x, y|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>mx = x;</p>
<p class="p16"><span class="Apple-tab-span">	</span>my = y;</p>
<p class="p16">};</p>
<p class="p16">u.mouseMoveAction = u.mouseDownAction;</p>
<p class="p16">w.front;</p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p14"><span class="s3">u.animate = </span><span class="s10">false</span><span class="s3">;<span class="Apple-tab-span">	</span></span>//animation can be paused and resumed</p>
<p class="p16">u.animate = <span class="s10">true</span>;</p>
<p class="p14"><span class="s3">w.close;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>//stops animation</p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p14">// Simple ball animation</p>
<p class="p14">//</p>
<p class="p15"><br></p>
<p class="p16">(</p>
<p class="p16"><span class="s10">var</span> width = 400, height = 400, xspeed = 3, yspeed = 2, x = width*0.5, y = height*0.5;</p>
<p class="p16">w = <span class="s10">Window</span>(<span class="s12">"ball"</span>, <span class="s10">Rect</span>(100, 200, width, height));</p>
<p class="p16">u = <span class="s10">UserView</span>(w, <span class="s10">Rect</span>(0, 0, width, height));</p>
<p class="p16">u.background = <span class="s10">Color</span>.black;</p>
<p class="p16">u.animate = <span class="s10">true</span>;</p>
<p class="p16">u.drawFunc = {</p>
<p class="p16"><span class="Apple-tab-span">	</span>if(x&lt;0 or:{x&gt;width}, {xspeed = 0-xspeed});</p>
<p class="p16"><span class="Apple-tab-span">	</span>if(y&lt;0 or:{y&gt;height}, {yspeed = 0-yspeed});</p>
<p class="p16"><span class="Apple-tab-span">	</span>x = x+xspeed;</p>
<p class="p16"><span class="Apple-tab-span">	</span>y = y+yspeed;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillColor = <span class="s10">Color</span>.white;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillOval(<span class="s10">Rect</span>.aboutPoint(<span class="s10">Point</span>(x, y), 8, 8));</p>
<p class="p16">};</p>
<p class="p16">w.front;</p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p14"><span class="s3">(<span class="Apple-tab-span">	</span></span>//replace the drawFunc above while running</p>
<p class="p16">u.drawFunc = {</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillColor = <span class="s10">Color</span>.red;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillOval(<span class="s10">Rect</span>(200, 200, sin(u.frame*0.031)*200, sin(u.frame*0.044)*200));</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillOval(<span class="s10">Rect</span>(200, 200, sin(u.frame*0.052)*200, sin(u.frame*0.065)*200));</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillOval(<span class="s10">Rect</span>(200, 200, sin(u.frame*0.073)*200, sin(u.frame*0.086)*200));</p>
<p class="p16">}</p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p14">//close the window to stop</p>
<p class="p16">w.close;</p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p14">// Clearing on Refresh</p>
<p class="p14">//</p>
<p class="p14">// Set the behaviour for refreshing the view.</p>
<p class="p14">// If this flag is true (the default) the view will be cleared before each refresh call,</p>
<p class="p14">// otherwise It will draw in top of it.</p>
<p class="p14">// On OSX this functionality is only available for the version &gt;= 10.4 .</p>
<p class="p15"><br></p>
<p class="p16">(</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">var</span> width = 640, height = 480, w, theta = 0, drawFunc;</p>
<p class="p16"><span class="Apple-tab-span">	</span>w = <span class="s10">Window</span>( <span class="s12">"trails"</span>, <span class="s10">Rect</span>( 128, 64, width, height ), <span class="s10">false</span> );</p>
<p class="p16"><span class="Apple-tab-span">	</span>drawFunc = { <span class="s10">arg</span> view;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">var</span> x = 20 * sin( theta ), y = 42 * cos( theta );</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>theta = theta + 0.01;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillColor_( <span class="s10">Color</span>.red( 0.2, 0.1 ));</p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s10">Pen</span><span class="s3">.fillRect( </span><span class="s10">Rect</span><span class="s3">( 0, 0, width, height ));</span>//draw a semitransparent rect filling the screen</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.strokeColor_( <span class="s10">Color</span>.white );</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.translate( width * 0.5, height * 0.5 );</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>6.do { <span class="s10">arg</span> i;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.rotate( theta * (1 - (i / 6)) );</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.scale( 0.7 + (i * 0.4), 0.4 + (i * 0.5) );</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.strokeOval( <span class="s10">Rect</span>.aboutPoint( <span class="s10">Point</span>( x, y ), 60, 40 ));</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p16"><span class="Apple-tab-span">	</span>};</p>
<p class="p16"><span class="Apple-tab-span">	</span>x = <span class="s10">UserView</span>( w, <span class="s10">Rect</span>( 10, 10, width - 20, height - 20 ))</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.canFocus_( <span class="s10">false</span> )</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.drawFunc_( drawFunc )</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.clearOnRefresh_( <span class="s10">false</span> );</p>
<p class="p15"><br></p>
<p class="p16"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p16"><span class="Apple-tab-span">	</span>x.animate = <span class="s10">true</span></p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p14">// Use refreshInRect(aRect).</p>
<p class="p14">// Constrains the receiver's refresh area to the rectangle passed in aRect.</p>
<p class="p14">// you may use Quartz Debug's flash screen updates to see the refresh area of the view</p>
<p class="p15"><br></p>
<p class="p16">(</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="s10">var</span> userView, win, blob = <span class="s10">Rect</span>(0, 0, 50, 50), trackblob=<span class="s10">false</span>, pmouse;</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p17"><span class="s3"><span class="Apple-tab-span">	</span>a = </span><span class="s10">SCImage</span><span class="s3">.new(</span>"/Library/Desktop Pictures/Ripples Blue.jpg"<span class="s3">);</span></p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>win = <span class="s10">SCWindow</span>.new(<span class="s12">"refreshInRect Test"</span>, <span class="s10">Rect</span>(400, 400, 600, 200), scroll:<span class="s10">true</span>).front;</p>
<p class="p16"><span class="Apple-tab-span">	</span>win.onClose_({ a.free; });</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>userView = <span class="s10">SCUserView</span>(win, <span class="s10">Rect</span>(10,10,2000,800))</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.backgroundImage_(a, 5)</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.drawFunc_({<span class="s10">|me|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Color</span>.blue.setFill;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">Pen</span>.fillRect(blob);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>})</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.mouseDownAction_({<span class="s10">|v, x, y, mod|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>pmouse = x@y;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>trackblob = blob.containsPoint(pmouse);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>})</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.mouseUpAction_({<span class="s10">|v, x, y, mod|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>trackblob = <span class="s10">false</span>;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>})</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.mouseMoveAction_({<span class="s10">|v, x, y, mod|</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s10">var</span> refresh, mouse, delta;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mouse = x@y;</p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(trackblob, {</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>refresh = blob.copy;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delta = mouse-pmouse;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>blob = blob.moveBy(delta.x, delta.y);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>refresh = refresh.union(blob);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>v.refreshInRect(refresh);</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>pmouse = mouse;</p>
<p class="p16"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p15"><span class="Apple-tab-span">	</span></p>
<p class="p16"><span class="Apple-tab-span">	</span>blob = blob.moveBy(userView.bounds.left, userView.bounds.top);</p>
<p class="p16"><span class="Apple-tab-span">	</span>userView.bounds.postln;</p>
<p class="p16">)</p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p15"><br></p>
<p class="p15"><br></p>
</body>
</html>

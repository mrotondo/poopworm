<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="949.43">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #ad140d}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco}
p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #001bb9}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #2c7014}
span.s1 {font: 18.0px Helvetica}
span.s2 {font: 9.0px Monaco}
span.s3 {color: #001bb9}
span.s4 {color: #0000ff}
span.s5 {color: #606060}
span.s6 {color: #000000}
span.s7 {color: #2c7014}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><span class="s1"><b>PatternProxy<span class="Apple-tab-span">	</span></b></span><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><b>stream reference</b></p>
<p class="p2"><br></p>
<p class="p1">superclass: Pattern</p>
<p class="p3"><br></p>
<p class="p3"><br></p>
<p class="p3"><br></p>
<p class="p1">keeps a reference to a stream that can be replaced while playing.</p>
<p class="p1">Multiple streams are thus handled without creating dependancies.</p>
<p class="p3"><br></p>
<p class="p1">related: <a href="Pdefn.html"><span class="s3">Pdefn</span></a></p>
<p class="p3"><br></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>*new(source)</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>create a new instance with a pattern (the source).</p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>the pattern should be a <i>value pattern</i> (see <b>Pdefn</b>)</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for event pattern proxy, see: <a href="EventPatternProxy.html"><span class="s4">EventPatternProxy</span></a></p>
<p class="p1"><i><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></i>instead of a pattern, a <b>function</b> can be passed in, creating a routine.</p>
<p class="p3"><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>*default</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a default source, if none is given. the default is 1.0 (it is not 0.0 in order to make it safe for durations)</p>
<p class="p3"><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>source_(obj)</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set the source. If a quantization is given, schedule this change to the next beat</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>clear</b><span class="Apple-tab-span">	</span>set the source to nil</p>
<p class="p3"><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>quant_</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set the quantization value</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>quant</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get the quantization value</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>*defaultQuant_</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set the default quantization value for the class. (default: nil)</p>
<p class="p3"><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>condition_(func)</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>provide a condition under which the pattern is switched when a new one is inserted.</p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>the stream value and a count is passed into the function</p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>the methods <b>count_(n) </b>simply counts up to n and switches the pattern then</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>reset</b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>switch the pattern immediately. (stuck conditions can be subverted by this)</p>
<p class="p3"><br></p>
<p class="p3"><br></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>embedInStream(inval)</b></p>
<p class="p1"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>just like any pattern, embeds itself in stream</p>
<p class="p3"><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span>PatternProxy implements some methods for the benefits of its subclasses Pdefn/Pdef/Tdef which</p>
<p class="p1"><span class="Apple-tab-span">	</span>are not useful for PatternProxy, EventStreamProxy and TaskProxy.</p>
<p class="p3"><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>envir_(event)</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>provide a default environment for the proxy.<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>If given,<span class="Apple-converted-space">  </span>it is used as an environment for the routine<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>function. When set for the first time, the routine pattern is rebuilt.</p>
<p class="p3"><span class="Apple-tab-span">	</span></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>set(key, val, key2, val2, ...)</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set arguments in the environment.<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>If there is none, it is created and the pattern is rebuilt.</p>
<p class="p3"><br></p>
<p class="p1"><span class="Apple-tab-span">	</span><b>endless</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>returns a Proutine that plays the proxy endlessly, replacing <b>nil</b> with a <b>default</b></p>
<p class="p1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value (1). This allows to create streams that idle on until a new pattern is inserted.</p>
<p class="p3"><br></p>
<p class="p4">// example</p>
<p class="p2"><br></p>
<p class="p5">a = <span class="s3">PatternProxy</span>(<span class="s3">Pseq</span>([1, 2, 3], <span class="s3">inf</span>));</p>
<p class="p2"><br></p>
<p class="p5">x = <span class="s3">Pseq</span>([0, 0, a], <span class="s3">inf</span>).asStream;</p>
<p class="p2"><br></p>
<p class="p5">t = <span class="s3">Task</span>({ loop({ x.next.postln; 0.3.wait }) }).play;</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p5">a.source = <span class="s3">Pseq</span>([55, 66, 77], <span class="s3">inf</span>);</p>
<p class="p5">a.source = <span class="s3">Pseq</span>([55, 66, 77], 1);</p>
<p class="p2"><br></p>
<p class="p5">t.stop;</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4">// PatternProxy, like Pdefn can be accessed in multiple streams</p>
<p class="p2"><br></p>
<p class="p5">(</p>
<p class="p5"><span class="s3">SynthDef</span>(<span class="s5">"Pdefhelp"</span>, { <span class="s3">arg</span> out, freq, sustain=1, amp=1, pan;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s3">var</span> env, u=1;</p>
<p class="p5"><span class="Apple-tab-span">	</span>env = <span class="s3">EnvGen</span>.kr(<span class="s3">Env</span>.perc(0.03, sustain), 1, doneAction:2);</p>
<p class="p5"><span class="Apple-tab-span">	</span>5.do { <span class="s3">var</span> d; d = exprand(0.01, 1); u = <span class="s3">SinOsc</span>.ar(d * 300, u, rrand(0.1,1.2) * d, 1) };</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s3">Out</span>.ar(out, <span class="s3">Pan2</span>.ar(<span class="s3">SinOsc</span>.ar(u + 1 * freq, 0, amp * env), pan));</p>
<p class="p2"><br></p>
<p class="p5">}).store;</p>
<p class="p5">s.boot;</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p5">(</p>
<p class="p6"><span class="s6">x = </span>PatternProxy<span class="s6">.new;</span></p>
<p class="p5">x.source = <span class="s3">Pseq</span>([0, 3, 2], <span class="s3">inf</span>);</p>
<p class="p2"><br></p>
<p class="p7"><span class="s3">Pset</span><span class="s6">(</span>\instrument<span class="s6">, </span>\Pdefhelp<span class="s6">,<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s6"><span class="Apple-tab-span">	</span></span>Ppar<span class="s6">([</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s3">Pbind</span>(<span class="s7">\degree</span>, x),</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s3">Pbind</span>(<span class="s7">\degree</span>, x, <span class="s7">\dur</span>, 1/3)</p>
<p class="p5">])</p>
<p class="p5">).play;</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p5">x.source = <span class="s3">Prand</span>([0, 3, [1s, 4]], <span class="s3">inf</span>);</p>
<p class="p2"><br></p>
<p class="p5">x.source = <span class="s3">Pn</span>(<span class="s3">Pshuf</span>([0, 3, 2, 7, 6], 2), <span class="s3">inf</span>);</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4">// if quant is set, the update is done at the next beat or whatever is specified:</p>
<p class="p2"><br></p>
<p class="p5">x.quant = 4;</p>
<p class="p5">x.source = <span class="s3">Pn</span>(<span class="s3">Pseries</span>(0, 1, 8), <span class="s3">inf</span>);</p>
<p class="p2"><br></p>
<p class="p4"><span class="s6">x.quant = </span><span class="s3">nil</span><span class="s6">; </span>// reactivate immediacy</p>
<p class="p2"><br></p>
<p class="p5">(</p>
<p class="p5">x.source = <span class="s3">Prout</span> {</p>
<p class="p5"><span class="Apple-tab-span">	</span>loop {</p>
<p class="p5"><span class="Apple-tab-span">	</span>4.do { <span class="s3">|i|</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>#[2, 3, 4].choose.yield;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>#[5, 0, 11].choose.yield;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>#[6, 3, 4].choose.do { <span class="s3">|j|</span> (i % j).yield };</p>
<p class="p5"><span class="Apple-tab-span">	</span>}</p>
<p class="p5"><span class="Apple-tab-span">	</span>}</p>
<p class="p5">}</p>
<p class="p5">)</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
</body>
</html>

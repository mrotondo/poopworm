<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="949.43">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica; min-height: 17.0px}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica}
p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #606060}
p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; color: #0041b2}
p.p10 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p11 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica}
p.p12 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p13 {margin: 0.0px 0.0px 0.0px 85.0px; text-indent: -85.0px; font: 12.0px Helvetica}
p.p14 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; color: #606060}
p.p15 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco}
p.p16 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; color: #972700}
p.p17 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 14.0px Helvetica}
p.p18 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; color: #ad2100}
p.p19 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; color: #b51800}
p.p20 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica; color: #606060}
p.p21 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica; color: #606060; min-height: 14.0px}
p.p22 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #0041b2}
p.p23 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #972700}
p.p24 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000; min-height: 12.0px}
p.p25 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #bf0000}
p.p26 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; color: #000000}
p.p27 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; color: #000000; min-height: 12.0px}
p.p28 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; color: #bf0000}
p.p29 {margin: 0.0px 0.0px 0.0px 0.0px; font: 8.0px Monaco; min-height: 11.0px}
p.p30 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #ba1100}
p.p31 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #ba1100; min-height: 12.0px}
p.p32 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #002dbd}
span.s1 {color: #0041b2}
span.s2 {color: #000000}
span.s3 {font: 12.0px Helvetica; color: #000000}
span.s4 {color: #154a84}
span.s5 {color: #4b6625}
span.s6 {color: #606060}
span.s7 {font: 11.0px Helvetica; color: #000000}
span.s8 {color: #972700}
span.s9 {color: #003fbb}
span.s10 {color: #ad2100}
span.s11 {color: #002dbd}
span.s12 {color: #b51800}
span.s13 {font: 9.0px Monaco}
span.s14 {font: 9.0px Monaco; color: #656240}
span.s15 {color: #0000bf}
span.s16 {color: #bf0000}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><b>SCNSObject</b></p>
<p class="p2"><br></p>
<p class="p3">Note: this is experimental (03/2006) things might change and be careful wrong or unsupported Cocoa-calls can crash this Application !</p>
<p class="p4"><br></p>
<p class="p5"><b>Object Creation - LifeCycle</b></p>
<p class="p4"><br></p>
<p class="p3">On creation only the init message is passed, alloc is called internally. Instance methods and Class methods are supported by the bridge, but if an object (id or SCNSObject) is returned by the method you owns it (even for autoreleased object - because they are retained internally by SuperCollider), so you must call <b>release</b> when you're done with it (SCNSObject(s) are not automatically garbage collected)</p>
<p class="p4"><br></p>
<p class="p5"><b>Invocation</b></p>
<p class="p4"><br></p>
<p class="p3">Once your Objective-C object is allocated / retained you can call it using <b>invoke</b></p>
<p class="p2"><br></p>
<p class="p3">Example:</p>
<p class="p3">The Objective-C synthax:</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s1">NSNumber</span> *n = [[<span class="s1">NSNumber</span> alloc] initWithFloat: 1.1];</p>
<p class="p6"><span class="Apple-tab-span">	</span>[n floatValue];</p>
<p class="p3">turns into:</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span>n = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSNumber"<span class="s2">, </span>"initWithFloat:"<span class="s2">, [1.1]);</span></p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span>n.invoke(</span>"floatValue"<span class="s2">);</span></p>
<p class="p8"><span class="Apple-tab-span">	</span></p>
<p class="p3">Multiple messages are put together in one String and their arguments in one Array.</p>
<p class="p2"><br></p>
<p class="p3">Example:</p>
<p class="p3">Cocoa:</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s1">NSWindow</span> *c = [[<span class="s1">NSWindow</span> alloc] initWithContentRect: rect styleMask: 10 backing: 2 defer:<span class="s1">YES</span>];</p>
<p class="p3">SC:</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span>c = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSWindow"<span class="s2">, </span>"initWithContentRect:styleMask:backing:defer:"<span class="s2">,[</span><span class="s1">Rect</span><span class="s2">(0,0,400,100), 10, 2, 1]);</span></p>
<p class="p8"><br></p>
<p class="p2"><br></p>
<p class="p5"><b>Deferring your calls</b></p>
<p class="p8"><br></p>
<p class="p3">Some methods need to be defered. If you want to defer ust call invoke with defer:true. Watch out there is no smart protection for methods that need defer until now! In general you should defer graphic operations.</p>
<p class="p3">So calling this might crash sc-lang:</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span></span><span class="s2">c.invoke(</span>"makeKeyAndOrderFront:"<span class="s2">, [</span><span class="s4">nil</span><span class="s2">]);<span class="Apple-tab-span">	</span></span></p>
<p class="p3">but this line is fine:</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span>c.invoke(</span>"makeKeyAndOrderFront:"<span class="s2">, [</span><span class="s4">nil</span><span class="s2">], </span><span class="s4">true</span><span class="s2">);<span class="Apple-tab-span">	</span></span></p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p5"><b>Common Conversion Table</b></p>
<p class="p4"><br></p>
<p class="p3">SuperCollider will try to convert types when possible, here are the most common types and their translation</p>
<p class="p3">betweem the 2 languages.</p>
<p class="p2"><br></p>
<p class="p3"><b>SuperCollider Types</b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-&gt;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>Objective-C Types<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(when using invoke / SCNSObject.new)</b></p>
<p class="p3">----------------------------------------------------------------------------------------------------</p>
<p class="p9">SCNSObject<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>id (</span>NSObject<span class="s2">)</span></p>
<p class="p3"><span class="s1">Nil</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">nil</span>, <span class="s1">NULL</span> pointer</p>
<p class="p3"><span class="s1">Number</span> (<span class="s1">Float</span>, <span class="s1">Integer</span>)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>float, int, long, short, char, <span class="s1">NSNumber</span></p>
<p class="p9">Boolean<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>YES<span class="s2">, </span>NO<span class="s2">, bool, </span>NSNumber</p>
<p class="p3"><span class="s1">String</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">NSString</span>, <span class="s1">SEL</span>, char*, void*</p>
<p class="p9">Rect<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>NSRect</p>
<p class="p9">Color<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>NSColor</p>
<p class="p9">Point<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>NSPoint<span class="s2">, </span>NSRange<span class="s2">, </span>NSSize</p>
<p class="p3"><span class="s1">Int8Array</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>void*, char*</p>
<p class="p3"><span class="s1">Int16Array</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>void*, short*</p>
<p class="p3"><span class="s1">Int32Array</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>void*, int*</p>
<p class="p3"><span class="s1">DoubleArray</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>void*, double*</p>
<p class="p3"><span class="s1">FloatArray</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>void*, float*</p>
<p class="p3"><span class="s1">Signal</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>float*</p>
<p class="p9">Array<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>QTTime<span class="s2">, </span>NSRange<span class="s2">, </span>NSSize<span class="s2">, </span>SCNSObject<span class="s2">*</span></p>
<p class="p2"><br></p>
<p class="p3"><b>Objective-C Types</b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-&gt;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>SuperCollider Types<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(on method return)</b></p>
<p class="p3">----------------------------------------------------------------------------------------------------</p>
<p class="p9">NSString<span class="s2">, char*<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>String</p>
<p class="p9">NSColor<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>Color</p>
<p class="p9">NSSize<span class="s2">, </span>NSRange<span class="s2">, </span>QTTime<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>Array</p>
<p class="p9">NSRect<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>Rect</p>
<p class="p9">NSPoint<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>Point</p>
<p class="p3"><span class="s1">BOOL</span>, long, char, int, short<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">Integer</span></p>
<p class="p3">float, double<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">Float</span></p>
<p class="p9"><span class="s2">c99 </span>_bool<span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>Boolean</p>
<p class="p3">*(pointer type)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">RawPointer</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3">id, (any other <span class="s1">NSObject</span>)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">SCNSObject</span></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p5"><b>Creation / Class Methods</b></p>
<p class="p10"><br></p>
<p class="p11"><b><span class="Apple-tab-span">	</span>*new(classname, initname, args, defer)</b></p>
<p class="p12"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p11"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Creates a new SCNSObject instance. SCNSObject creates a bridge between SuperCollider and Objective-C / Cocoa.</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>It holds an NSObject and sends messages to it. The class and messages are passed as Strings. Arguments must be in an Array.</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>classname </b>- The Objective-C name of the class you want to invoke / instantiate.</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>initname</b> - can be either a class method or an instance initX method, depending on the possible initialization call. You do not need to specify alloc if you instantiate an object, it is automatically done for you.</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>args</b> - the Array of arguments for the initname method.</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>defer</b> - defer the call. default is false.</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p14"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSHost"<span class="s2">, </span>"currentHost"<span class="s2">);</span></p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[<span class="s5">\name</span>, a.invoke(<span class="s6">"name"</span>), <span class="s5">\address</span>, a.invoke(<span class="s6">"address"</span>)].postln;</p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a.release;</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><b>*newFromRawPointer(ptr)</b></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Creates a new SCNSObject from a RawPointer. Might be handy for very special occasion.</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="s7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s2">i = </span><span class="s1">SCImage</span><span class="s2">.new(</span>"/Library/Desktop Pictures/Ripples Blue.jpg"<span class="s2">);</span></p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a = <span class="s1">SCNSObject</span>.newFromRawPointer(i.slotAt(0)).invoke(<span class="s6">"nsimage"</span>);</p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a.className.postln; <span class="s8">// verify :)</span></p>
<p class="p16"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// now do what you want with the NSImage of the SCImage</p>
<p class="p16"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i.free; </span>// release it when done</p>
<p class="p16"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// you do not have here to release the SCNSObject - it is dangerous to do so in this case</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><b>*dumpPool</b></p>
<p class="p2"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></p>
<p class="p3"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Dump the current NSObjects in the pool, so retained by SuperCollider.</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><b>*freePool</b></p>
<p class="p2"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></p>
<p class="p3"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Release all the current NSObjects in the pool and clear it. Call this method only if you really</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>know what you are doing : all the SCNSObjects will be unvalidated !</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p17"><b>Instance Methods</b></p>
<p class="p12"><span class="Apple-tab-span">	</span></p>
<p class="p11"><b><span class="Apple-tab-span">	</span>invoke(method, args, defer)</b></p>
<p class="p12"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></p>
<p class="p11"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Invoke an SCNSObject</p>
<p class="p11"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>method </b>- The method to call the receiver with</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>args </b>- The arguments Array</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>defer</b> - defer the call. default is false. (might be needed for GUI otherwise you may experience a crash)</p>
<p class="p12"><span class="Apple-tab-span">	</span></p>
<p class="p11"><span class="Apple-tab-span">	</span><b>release</b></p>
<p class="p12"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></p>
<p class="p11"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Release the internal NSObject retained by the application pool.</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>You must call this method when you're done with your object.</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><i>Note that it is not fully equivalent to a [myObject release], the NSObject is removed from the pool so if the application is the only one who retained it and owns it, it will properly dealloc it. But if the object is not IN the pool, it won't do anything.</i></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>example:</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p18"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s9">SCNSObject</span><span class="s2">.freePool; </span>// free all object first to see</p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s2">i = </span><span class="s9">SCImage</span><span class="s2">.new(</span>"/Library/Desktop Pictures/Ripples Blue.jpg"<span class="s2">); </span><span class="s10">// create a simple SCImage</span></p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a = <span class="s9">SCNSObject</span>.newFromRawPointer(i.slotAt(0)); <span class="s10">// get the SCImage object</span></p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a.className; <span class="s10">// SCImage</span></p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a.invoke(<span class="s6">"size"</span>);</p>
<p class="p18"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s9">SCNSObject</span><span class="s2">.dumpPool; </span>// look, we do not have any NSObject in our pool</p>
<p class="p19"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// a.release; // so this won't do anything - just clear our NSObject ref - note that the SCImage is not IN the pool</p>
<p class="p18"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a.invoke(</span><span class="s6">"retain"</span><span class="s2">); </span>// now we can retain the SCImage - but since the method returns the object it is also added - retained also in the pool !</p>
<p class="p18"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i.free; </span>// release the SCImage</p>
<p class="p18"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s9">SCNSObject</span><span class="s2">.dumpPool; </span>// look the SCImage is here</p>
<p class="p18"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a.invoke(</span><span class="s6">"release"</span><span class="s2">); </span>// now we have to release it twice</p>
<p class="p15"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s11">SCNSObject</span>.dumpPool; <span class="s12">//</span></p>
<p class="p19"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a.release; </span>// should be fine</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p11"><span class="Apple-tab-span">	</span><b>initAction(actionName)</b></p>
<p class="p12"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></p>
<p class="p11"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Creates a CocoaAction, a special delegate to handle Target / Action mechanism (See explainations above). <b>initAction</b> is a convenience method to add an action to a gui element, mostly for <b>NSControl</b> subclasses. Once an action is setted, a special delegate is created on your behalf to wich you can attach a action. You can access this delegate using the <b>nsAction</b> accessor method.</p>
<p class="p20"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>actionName </b>- may be </span>"doFloatAction:" <span class="s2">(default)</span>, "doIntAction:", "doStateAction:" <span class="s2">or </span>"doAction:"</p>
<p class="p21"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s13">(</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">var</span> win, topview, slider;</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSWindow"<span class="s2">, </span>"initWithContentRect:styleMask:backing:defer:"<span class="s2">, [</span><span class="s1">Rect</span><span class="s2">(100,140,400,30), 10, 2, 1]);</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win.registerNotification(<span class="s6">"NSWindowWillCloseNotification"</span>, {<span class="s1">|name, nsnotification, object|</span><span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[win, topview, slider].do { <span class="s1">|obj|</span> obj.release };</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[name, nsnotification, object].postln}</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>slider = <span class="s1">SCNSObject</span>(<span class="s6">"NSSlider"</span>, <span class="s6">"initWithFrame:"</span>, [<span class="s1">Rect</span>(0,0,390,20)]);<span class="Apple-converted-space"> </span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>slider.invoke(<span class="s6">"setFloatValue:"</span>, [0.5]);</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>slider.initAction.action_({<span class="s1">|v,val|</span> val.postln});</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>topview = win.invoke(<span class="s6">"contentView"</span>);</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>topview.invoke(<span class="s6">"addSubview:"</span>, [slider]);</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win.invoke(<span class="s6">"makeKeyAndOrderFront:"</span>, [win], <span class="s1">true</span>);</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win.invoke(</span>"setTitle:"<span class="s2">, [</span>"cocoa test"<span class="s2">]);</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>)</p>
<p class="p21"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p11"><span class="s6"><span class="Apple-tab-span">	</span></span><b>setDelegate</b></p>
<p class="p12"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></p>
<p class="p11"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Creates a special CocoaAction delegate object to handle delegate methods and notifications. Should not be confused with the nsAction one. This delegate can be retrieved with the <b>nsDelegate</b> accessor.</p>
<p class="p21"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p11"><span class="s6"><span class="Apple-tab-span">	</span></span><b>registerNotification( aNotificationName, aFunc, obj )</b></p>
<p class="p12"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></p>
<p class="p11"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>Register a special notification (see NSNotification) with a Function that will be triggered each time it is sent. This method will create a defaut <b>nsDelegate</b> if it does exist already.</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>aNotificationName </b>- The name of the notification</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>aFunc </b>- The responder function</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>obj </b>- the object of the notification, default is this.</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s13">(</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">var</span> win, delegate;</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSWindow"<span class="s2">, </span>"initWithContentRect:styleMask:backing:defer:"<span class="s2">, [</span><span class="s1">Rect</span><span class="s2">(100,400,400,400), 10, 2, 1]);</span></p>
<p class="p22"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win.registerNotification(</span><span class="s6">"NSWindowWillCloseNotification"</span><span class="s2">, {</span>|name, nsnotification, object, delegate|<span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[delegate <span class="s8">/* the window.nsDelegate */</span>, delegate.object <span class="s8">/* the win SCNSObject */</span>, name, nsnotification, object].postln;</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win.release;</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win.invoke(<span class="s6">"setMinSize:"</span>, [[100,100]]);</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win.invoke(<span class="s6">"makeKeyAndOrderFront:"</span>, [win], <span class="s1">true</span>);</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>win.invoke(</span>"setTitle:"<span class="s2">, [</span>"notification test - Close Me"<span class="s2">]);</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>)</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><b>asArray( arrayType )</b></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SCNSObject holding an NSData object can be converted to array types using the <b>asArray</b> method.<span class="Apple-converted-space"> </span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>arrayType </b>- <span class="s14">\string</span><span class="s13"> </span><span class="s14">\int8</span><span class="s13"> </span><span class="s14">\int16</span><span class="s13"> </span><span class="s14">\int32</span><span class="s13"> </span><span class="s14">\float</span><span class="s13"> </span><span class="s14">\double</span><span class="s13"> </span>are the possible argument for an explicit conversion.</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>d = </span><span class="s1">SCNSObject</span><span class="s2">.new(</span>"NSData"<span class="s2">, </span>"dataWithBytes:length:"<span class="s2">, [</span>"hellomydear"<span class="s2">, 11]); </span><span class="s8">// 11 bytes passed</span></p>
<p class="p23"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e = d.asArray(</span><span class="s5">\string</span><span class="s2">); </span>// get it back as a String</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>d.release;</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>d = <span class="s1">SCNSObject</span>.new(<span class="s6">"NSData"</span>, <span class="s6">"dataWithBytes:length:"</span>, [<span class="s1">Int32Array</span>[98,99,100,101], 4*4]); <span class="s8">// 4x32bit integers = 16 bytes</span></p>
<p class="p23"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e = d.asArray(</span><span class="s5">\int32</span><span class="s2">); </span>// get it back as an Int32Array</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>d.release;</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>d = <span class="s1">SCNSObject</span>.new(<span class="s6">"NSData"</span>, <span class="s6">"dataWithBytes:length:"</span>, [<span class="s1">Int16Array</span>[98,99,100,101], 4*2]); <span class="s8">// 4x16bit integers = 8 bytes</span></p>
<p class="p23"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e = d.asArray(</span><span class="s5">\int16</span><span class="s2">); </span>// get it back an Int16Array</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>d.release;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3">Examples:</p>
<p class="p23">//create a window and add a Slider that posts its value.</p>
<p class="p6">(</p>
<p class="p6"><span class="s1">var</span> win, slider;</p>
<p class="p8"><br></p>
<p class="p7"><span class="s2">win = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSWindow"<span class="s2">, </span>"initWithContentRect:styleMask:backing:defer:"<span class="s2">,</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>[<span class="s1">Rect</span>(100,140,400,30), 10, 2, 1]);</p>
<p class="p23"><span class="s2">win.setDelegate.action_({ </span>// for NSWindow objects using setDelegate.action will trigger the nsAction.action function when it is closed</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span></span>"closing window, releasing objects"<span class="s2">.postln;</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>[slider,e].do{<span class="s1">|it|</span> it.release};</p>
<p class="p6">});</p>
<p class="p6">slider = <span class="s1">SCNSObject</span>(<span class="s6">"NSSlider"</span>, <span class="s6">"initWithFrame:"</span>, [<span class="s1">Rect</span>(0,0,390,20)]);<span class="Apple-converted-space"> </span></p>
<p class="p7"><span class="s2">e = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"SCGraphView"<span class="s2">, </span>"initWithFrame:"<span class="s2">, [</span><span class="s1">Rect</span><span class="s2">(0,0,400,30)]);<span class="Apple-converted-space"> </span></span></p>
<p class="p6">win.invoke(<span class="s6">"setContentView:"</span>, [e], <span class="s1">true</span>);</p>
<p class="p6">e.invoke(<span class="s6">"addSubview:"</span>, [slider], <span class="s1">true</span>);</p>
<p class="p6">slider.invoke(<span class="s6">"setFloatValue:"</span>, [0.5]);</p>
<p class="p7"><span class="s2">win.invoke(</span>"makeKeyAndOrderFront:"<span class="s2">, [</span><span class="s1">nil</span><span class="s2">], </span><span class="s1">true</span><span class="s2">);</span></p>
<p class="p7"><span class="s2">win.invoke(</span>"setTitle:"<span class="s2">, [</span>"cocoa test"<span class="s2">]);</span></p>
<p class="p8"><br></p>
<p class="p6">{</p>
<p class="p6">a = slider.initAction;</p>
<p class="p6">a.action_({<span class="s1">|v,val|</span> val.postln});}.defer(0.1);</p>
<p class="p6">~win = win;</p>
<p class="p6">)</p>
<p class="p8"><br></p>
<p class="p6">~win.className</p>
<p class="p6">~win.invoke(<span class="s6">"close"</span>, defer:<span class="s1">true</span>);</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p6">(</p>
<p class="p7"><span class="s2">c = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSWindow"<span class="s2">, </span>"initWithContentRect:styleMask:backing:defer:"<span class="s2">,[</span><span class="s1">Rect</span><span class="s2">(0,0,400,100), 10, 2, 1]);</span></p>
<p class="p23"><span class="s2">c.setDelegate.action_({ </span>// for NSWindow objects using setDelegate.action will trigger the nsAction.action function when it is closed</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span></span>"closing window, releasing objects"<span class="s2">.postln;</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>[c,d,e].do{<span class="s1">|it|</span> it.release};</p>
<p class="p6">});</p>
<p class="p7"><span class="s2">d = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSTextField"<span class="s2">, </span>"initWithFrame:"<span class="s2">, [</span><span class="s1">Rect</span><span class="s2">(0,0,100,20)]);<span class="Apple-converted-space"> </span></span></p>
<p class="p6">e = <span class="s1">SCNSObject</span>(<span class="s6">"NSView"</span>, <span class="s6">"initWithFrame:"</span>, [<span class="s1">Rect</span>(0,0,400,100)]);<span class="Apple-converted-space"> </span></p>
<p class="p6">c.invoke(<span class="s6">"setContentView:"</span>, [e], <span class="s1">true</span>);</p>
<p class="p6">e.invoke(<span class="s6">"addSubview:"</span>, [d], <span class="s1">true</span>);</p>
<p class="p7"><span class="s2">c.invoke(</span>"makeKeyAndOrderFront:"<span class="s2">, [</span><span class="s1">nil</span><span class="s2">], </span><span class="s1">true</span><span class="s2">);</span></p>
<p class="p6">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p6">(</p>
<p class="p7"><span class="s2">c = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSWindow"<span class="s2">, </span>"initWithContentRect:styleMask:backing:defer:"<span class="s2">,[</span><span class="s1">Rect</span><span class="s2">(100,100,100,20), 10, 2, 1]);</span></p>
<p class="p23"><span class="s2">c.setDelegate.action_({ </span>// for NSWindow objects using setDelegate.action will trigger the nsAction.action function when it is closed</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span></span>"closing window, releasing objects"<span class="s2">.postln;</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>[c,d,e].do{<span class="s1">|it|</span> it.release};</p>
<p class="p6">});</p>
<p class="p6">d = <span class="s1">SCNSObject</span>(<span class="s6">"NSButton"</span>, <span class="s6">"initWithFrame:"</span>, [<span class="s1">Rect</span>(0,0,100,20)]);<span class="Apple-converted-space"> </span></p>
<p class="p6">e = <span class="s1">SCNSObject</span>(<span class="s6">"NSView"</span>, <span class="s6">"initWithFrame:"</span>, [<span class="s1">Rect</span>(0,0,400,100)]);<span class="Apple-converted-space"> </span></p>
<p class="p6">c.invoke(<span class="s6">"setContentView:"</span>, [e], <span class="s1">true</span>);</p>
<p class="p6">e.invoke(<span class="s6">"addSubview:"</span>, [d], <span class="s1">true</span>);</p>
<p class="p7"><span class="s2">c.invoke(</span>"makeKeyAndOrderFront:"<span class="s2">, [</span><span class="s1">nil</span><span class="s2">], </span><span class="s1">true</span><span class="s2">);</span></p>
<p class="p6">d.invoke(<span class="s6">"setButtonType:"</span>, [3]);</p>
<p class="p6">{</p>
<p class="p7"><span class="s2">d.initAction(</span>"doStateAction:"<span class="s2">);</span></p>
<p class="p6">d.nsAction.action_({<span class="s1">|it,val|</span> val.postln;});</p>
<p class="p6">}.defer(0.1);</p>
<p class="p6">)</p>
<p class="p8"><br></p>
<p class="p24"><br></p>
<p class="p25">/*</p>
<p class="p25">simple QTMovie example</p>
<p class="p25">creates a movie in the SuperCollider folder + adds an image to it</p>
<p class="p25">*/</p>
<p class="p24"><br></p>
<p class="p26">(</p>
<p class="p14"><span class="s2">d = </span><span class="s15">SCNSObject</span><span class="s2">(</span>"NSMutableDictionary"<span class="s2">, </span>"dictionary"<span class="s2">);</span></p>
<p class="p14"><span class="s2">d.invoke(</span>"setObject:forKey:"<span class="s2">, [</span>"jpeg"<span class="s2">, </span>"QTAddImageCodecType"<span class="s2">]);</span></p>
<p class="p27"><br></p>
<p class="p14"><span class="s2">e = </span><span class="s15">SCNSObject</span><span class="s2">(</span>"NSMutableDictionary"<span class="s2">, </span>"dictionary"<span class="s2">);</span></p>
<p class="p14"><span class="s2">e.invoke(</span>"setObject:forKey:"<span class="s2">, [</span><span class="s15">true</span><span class="s2">, </span>"QTMovieFlatten"<span class="s2">]);</span></p>
<p class="p27"><br></p>
<p class="p14"><span class="s2">m = </span><span class="s15">SCNSObject</span><span class="s2">(</span>"QTMovie"<span class="s2">, </span>"initToWritableFile:error:"<span class="s2">, [</span><span class="s15">Platform</span><span class="s2">.classLibraryDir ++ </span>"/../test.mov"<span class="s2">, </span><span class="s15">nil</span><span class="s2">]); </span><span class="s16">// creates an empty movie</span></p>
<p class="p14"><span class="s2">i = </span><span class="s15">SCImage</span><span class="s2">(</span>"/Library/Desktop Pictures/Ripples Blue.jpg"<span class="s2">);</span></p>
<p class="p27"><br></p>
<p class="p28">// newFromRawPointer does not need any release so fine to get the invocation result directly</p>
<p class="p26">a = <span class="s15">SCNSObject</span>.newFromRawPointer(i.slotAt(0)).invoke(<span class="s6">"nsimage"</span>); <span class="s16">// this is how you can create a NSImage from<span class="Apple-converted-space"> </span></span></p>
<p class="p14"><span class="s2">m.invoke(</span>"addImage:forDuration:withAttributes:"<span class="s2">, [a, [3, 1], d]); </span><span class="s16">// 3 seconds</span></p>
<p class="p14"><span class="s2">m.invoke(</span>"updateMovieFile"<span class="s2">);</span></p>
<p class="p27"><br></p>
<p class="p26">[m, d, e].do ({ <span class="s15">|object|</span> object.release; });</p>
<p class="p26">i.free;</p>
<p class="p26">)</p>
<p class="p8"><br></p>
<p class="p23">// HUD Panels - 10.5 only</p>
<p class="p6">(</p>
<p class="p6">w = <span class="s1">SCNSObject</span>(<span class="s6">"NSPanel"</span>, <span class="s6">"initWithContentRect:styleMask:backing:defer:"</span>, [<span class="s1">Rect</span>(250, 250, 300, 200), (1&lt;&lt;13) + (1&lt;&lt;4) + 4 + 2 + 8, 2, <span class="s1">true</span>]);</p>
<p class="p22"><span class="s2">w.registerNotification(</span><span class="s6">"NSWindowWillCloseNotification"</span><span class="s2">, {</span>|notificationName,nsNotification|</p>
<p class="p6"><span class="Apple-tab-span">	</span>w.release;</p>
<p class="p6">});</p>
<p class="p7"><span class="s2">w.invoke(</span>"makeKeyAndOrderFront:"<span class="s2">, [</span><span class="s1">nil</span><span class="s2">], </span><span class="s1">true</span><span class="s2">);</span></p>
<p class="p6">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p23">/*----------------------</p>
<p class="p23">Notification Examples</p>
<p class="p23">using Webview</p>
<p class="p23">________________________*/</p>
<p class="p8"><br></p>
<p class="p6">(</p>
<p class="p6"><span class="s1">var</span> win, root, cocoaUI, cell, webview, levelIndicator;</p>
<p class="p7"><span class="s2">win = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSWindow"<span class="s2">, </span>"initWithContentRect:styleMask:backing:defer:"<span class="s2">, [</span><span class="s1">Rect</span><span class="s2">(250, 250, 800, 600), 15, 2, 1]);</span></p>
<p class="p8"><br></p>
<p class="p6">root = <span class="s1">SCNSObject</span>(<span class="s6">"NSView"</span>, <span class="s6">"initWithFrame:"</span>, [<span class="s1">Rect</span>(0, 0, 800, 600)]);</p>
<p class="p6">root.invoke(<span class="s6">"setAutoresizingMask:"</span>, [1 + 2 + 8 + 16]);</p>
<p class="p8"><br></p>
<p class="p7"><span class="s2">webview = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"WebView"<span class="s2">, </span>"initWithFrame:frameName:groupName:"<span class="s2">, [</span><span class="s1">Rect</span><span class="s2">(10, 30, 800-20, 600-40), </span>"mywebview"<span class="s2">, </span>"mywebviewgroup"<span class="s2">]);</span></p>
<p class="p6">webview.invoke(<span class="s6">"setAutoresizingMask:"</span>, [1 + 2 + 8 + 16]);</p>
<p class="p8"><br></p>
<p class="p23"><span class="s2">~webview = webview; </span>// just to retrieve the source after</p>
<p class="p8"><br></p>
<p class="p7"><span class="s2">cell = </span><span class="s1">SCNSObject</span><span class="s2">(</span>"NSLevelIndicatorCell"<span class="s2">, </span>"initWithLevelIndicatorStyle:"<span class="s2">, [1]);</span></p>
<p class="p6">levelIndicator = <span class="s1">SCNSObject</span>(<span class="s6">"NSLevelIndicator"</span>, <span class="s6">"initWithFrame:"</span>, [<span class="s1">Rect</span>(10, 5, 800-20, 10)]);</p>
<p class="p6">levelIndicator.invoke(<span class="s6">"setCell:"</span>, [cell]);</p>
<p class="p6">levelIndicator.invoke(<span class="s6">"setMinValue:"</span>, [0]);</p>
<p class="p6">levelIndicator.invoke(<span class="s6">"setMaxValue:"</span>, [100]);</p>
<p class="p6">levelIndicator.invoke(<span class="s6">"setFloatValue:"</span>, [0]);</p>
<p class="p6">levelIndicator.invoke(<span class="s6">"setContinuous:"</span>, [<span class="s1">true</span>]);</p>
<p class="p6">cell.release;</p>
<p class="p8"><br></p>
<p class="p6">cocoaUI.add(root);</p>
<p class="p6">cocoaUI.add(webview);</p>
<p class="p6">cocoaUI.add(levelIndicator);</p>
<p class="p8"><br></p>
<p class="p6">win.invoke(<span class="s6">"setContentView:"</span>, [root]);</p>
<p class="p6">root.invoke(<span class="s6">"addSubview:"</span>, [webview]);</p>
<p class="p6">root.invoke(<span class="s6">"addSubview:"</span>, [levelIndicator]);</p>
<p class="p8"><br></p>
<p class="p23">///// Notifications</p>
<p class="p23">// Window<span class="Apple-converted-space"> </span></p>
<p class="p7"><span class="s2">win.registerNotification(</span>"NSWindowWillCloseNotification"<span class="s2">, {</span></p>
<p class="p22"><span class="s2"><span class="Apple-tab-span">	</span></span>|notificationName, nsNotificationObjectAsRawPointer|</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span></span>"closing window"<span class="s2">.postln;</span></p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span>cocoaUI.do {</span><span class="s1">|ui|</span><span class="s2"> ui.invoke(</span>"removeFromSuperviewWithoutNeedingDisplay"<span class="s2">)};</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>win.release;</p>
<p class="p6"><span class="Apple-tab-span">	</span>root.release;</p>
<p class="p6"><span class="Apple-tab-span">	</span>webview.release;</p>
<p class="p6"><span class="Apple-tab-span">	</span>levelIndicator.release;</p>
<p class="p6"><span class="Apple-tab-span">	</span>~webview = <span class="s1">nil</span>;</p>
<p class="p6">});</p>
<p class="p8"><br></p>
<p class="p7"><span class="s2">win.registerNotification(</span>"NSWindowDidMoveNotification"<span class="s2">, {</span></p>
<p class="p22"><span class="s2"><span class="Apple-tab-span">	</span></span>|notificationName, nsNotificationObjectAsRawPointer|</p>
<p class="p6"><span class="Apple-tab-span">	</span>notificationName.postln;</p>
<p class="p6">});</p>
<p class="p8"><br></p>
<p class="p7"><span class="s2">win.registerNotification(</span>"NSWindowDidMiniaturizeNotification"<span class="s2">, {</span></p>
<p class="p22"><span class="s2"><span class="Apple-tab-span">	</span></span>|notificationName, nsNotificationObjectAsRawPointer|</p>
<p class="p6"><span class="Apple-tab-span">	</span>notificationName.postln;</p>
<p class="p6">});</p>
<p class="p23">// Webview Notifications</p>
<p class="p7"><span class="s2">webview.registerNotification(</span>"WebProgressEstimateChangedNotification"<span class="s2">, {</span></p>
<p class="p22"><span class="s2"><span class="Apple-tab-span">	</span></span>|notificationName, nsNotificationObjectAsRawPointer|</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s1">var</span> value;</p>
<p class="p6"><span class="Apple-tab-span">	</span>value = webview.invoke(<span class="s6">"estimatedProgress"</span>);</p>
<p class="p6"><span class="Apple-tab-span">	</span>levelIndicator.invoke(<span class="s6">"setFloatValue:"</span>, [value*100]);</p>
<p class="p6"><span class="Apple-tab-span">	</span>(<span class="s6">"loading progress: "</span>+ (value*100) + <span class="s6">"%"</span>).postln;</p>
<p class="p6">});</p>
<p class="p8"><br></p>
<p class="p7"><span class="s2">webview.registerNotification(</span>"WebProgressFinishedNotification"<span class="s2">, {</span></p>
<p class="p22"><span class="s2"><span class="Apple-tab-span">	</span></span>|notificationName, nsNotificationObjectAsRawPointer|</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s1">var</span> t0, t1;</p>
<p class="p6"><span class="Apple-tab-span">	</span>levelIndicator.invoke(<span class="s6">"setFloatValue:"</span>, [0]);</p>
<p class="p6"><span class="Apple-tab-span">	</span>t0 = webview.invoke(<span class="s6">"mainFrame"</span>);</p>
<p class="p6"><span class="Apple-tab-span">	</span>t1 = t0.invoke(<span class="s6">"dataSource"</span>); t0.release;</p>
<p class="p6"><span class="Apple-tab-span">	</span>t0 = t1.invoke(<span class="s6">"initialRequest"</span>); t1.release;</p>
<p class="p6"><span class="Apple-tab-span">	</span>t1 = t0.invoke(<span class="s6">"URL"</span>); t0.release;</p>
<p class="p6"><span class="Apple-tab-span">	</span>t0 = t1.invoke(<span class="s6">"absoluteString"</span>); t1.release;</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span>(t0 ++ </span>" finished Loading"<span class="s2">).postln;</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>win.invoke(<span class="s6">"setTitle:"</span>, [t0]);</p>
<p class="p6">});</p>
<p class="p23">///// Show Window</p>
<p class="p7"><span class="s2">win.invoke(</span>"makeKeyAndOrderFront:"<span class="s2">, [win], </span><span class="s1">true</span><span class="s2">);</span></p>
<p class="p8"><br></p>
<p class="p23">///// URL Loading</p>
<p class="p6">{</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s1">var</span> url;</p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span>url = </span>"http://swiki.hfbk-hamburg.de:8888/MusicTechnology/6"<span class="s2">;</span></p>
<p class="p6"><span class="Apple-tab-span">	</span>webview.invoke(<span class="s6">"setMainFrameURL:"</span>, [url]);</p>
<p class="p6"><span class="Apple-tab-span">	</span><span class="s1">SCNSObject</span>.dumpPool;</p>
<p class="p6">}.defer(0.2);</p>
<p class="p6">)</p>
<p class="p29"><br></p>
<p class="p23">/*----------------------</p>
<p class="p23">NSData conversion</p>
<p class="p23">using Webview html source</p>
<p class="p23">Do not close the window before you exec this code or reload previous example !</p>
<p class="p23">________________________*/</p>
<p class="p6">(</p>
<p class="p23">/// interpret it AFTER previous example for getting source html file</p>
<p class="p6"><span class="s1">var</span> mainframe, datasource, nsdata;</p>
<p class="p6">mainframe = ~webview.invoke(<span class="s6">"mainFrame"</span>);</p>
<p class="p6">datasource = mainframe.invoke(<span class="s6">"dataSource"</span>); mainframe.release;</p>
<p class="p6">nsdata = datasource.invoke(<span class="s6">"data"</span>); datasource.release;</p>
<p class="p6">nsdata.isSubclassOf(<span class="s6">"NSData"</span>).postln; <span class="s8">//<span class="Apple-converted-space"> </span></span></p>
<p class="p7">"---- HTML Source ----"<span class="s2">.postln;</span></p>
<p class="p6">nsdata.asArray(<span class="s5">\string</span>).postln;</p>
<p class="p7">"---- End of HTML Source ----"<span class="s2">.postln;</span></p>
<p class="p6">nsdata.release;</p>
<p class="p6">)</p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p30">/*----------------------</p>
<p class="p30">special Delegates actions with return values</p>
<p class="p30">using NSURLConnection as an example</p>
<p class="p30">________________________*/</p>
<p class="p8"><br></p>
<p class="p30">/*</p>
<p class="p30">(</p>
<p class="p30">var url;</p>
<p class="p31"><br></p>
<p class="p30">// first URL Request</p>
<p class="p30">url = SCNSObject("NSURL", "initWithString:", ["http://www.audiosynth.com"]);</p>
<p class="p30">~urlRequest = SCNSObject("NSURLRequest", "requestWithURL:cachePolicy:timeoutInterval:", [url, 0, 60]); url.release;</p>
<p class="p31"><br></p>
<p class="p30">// redirection to set after delegate call</p>
<p class="p30">url = SCNSObject("NSURL", "initWithString:", ["http://www.apple.com"]);</p>
<p class="p30">~redirection = SCNSObject("NSURLRequest", "requestWithURL:cachePolicy:timeoutInterval:", [url, 0, 60]); url.release;</p>
<p class="p31"><br></p>
<p class="p30">// we need here to set a void object to set its delegate before it is allocated really</p>
<p class="p30">// because urlConnection does not have a setDelegate: method</p>
<p class="p30">~urlConnection = SCNSObject.newClear;</p>
<p class="p30">~urlConnection.setDelegate; // create and attach a special delegate</p>
<p class="p30">~urlConnection.nsDelegate.addMethod("connectionDidFinishLoading:", nil, "@", {</p>
<p class="p30">|method, args| [method, args].postln;</p>
<p class="p30">});</p>
<p class="p31"><br></p>
<p class="p30">//// Custom Delegate Method with return values allowed (automatic conversion for most)</p>
<p class="p30">//// Here we have to provide the (name, return type of the delegate method, and the type encoding for the arguments)</p>
<p class="p30">//// see http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_13_section_9.html#//apple_ref/doc/uid/TP30001163-CH9-TPXREF165 for explanations</p>
<p class="p30">~urlConnection.nsDelegate.addMethod("connection:didReceiveResponse:", nil, "@@", {</p>
<p class="p30"><span class="Apple-tab-span">	</span>|method, args| [method, args].postln;</p>
<p class="p30">});</p>
<p class="p31"><br></p>
<p class="p30">~urlConnection.nsDelegate.addMethod("connection:willSendRequest:redirectResponse:", "@", "@@@", {</p>
<p class="p30"><span class="Apple-tab-span">	</span>|method, arguments|</p>
<p class="p30"><span class="Apple-tab-span">	</span>[method, arguments].postln;</p>
<p class="p30"><span class="Apple-tab-span">	</span>url = ~redirection.invoke("URL");</p>
<p class="p30"><span class="Apple-tab-span">	</span>("redirecting to "++url.invoke("absoluteString")).postln; url.release;</p>
<p class="p30"><span class="Apple-tab-span">	</span>^~redirection; // redirect !</p>
<p class="p30">});</p>
<p class="p31"><br></p>
<p class="p30">// we can init the object now</p>
<p class="p30">~urlConnection.init("NSURLConnection", "initWithRequest:delegate:", [~urlRequest, ~urlConnection.nsDelegate]); // now we can alloc the object and attach its delegate</p>
<p class="p30">)</p>
<p class="p31"><br></p>
<p class="p30">(</p>
<p class="p30">~urlConnection.release;</p>
<p class="p30">~urlRequest.release;</p>
<p class="p30">~redirection.release;</p>
<p class="p30">)</p>
<p class="p30">*/</p>
<p class="p8"><br></p>
<p class="p6"><span class="s11">SCNSObject</span>.dumpPool;</p>
<p class="p32">SCNSObject<span class="s2">.freePool;</span></p>
<p class="p8"><br></p>
</body>
</html>
